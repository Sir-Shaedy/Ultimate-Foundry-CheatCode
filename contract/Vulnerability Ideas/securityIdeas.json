"This boilerplate contains most smart contract vulnerabilities discovered in 30+ security reviews.": {
    "prefix": "idea",
    "body": [
        "// SPDX-License-Identifier: MIT",
        "pragma solidity ^0.8.20;",
        "",
        "import \"forge-std/Test.sol\";",
        "import \"forge-std/Script.sol\"; // makeAddr, deal",
        "",
        "// OpenZeppelin mocks and interfaces",
        "import \"@openzeppelin/contracts/mocks/ERC20Mock.sol\";",
        "import \"@openzeppelin/contracts/mocks/ERC4626Mock.sol\";",
        "",
        "// import your contracts",
        "",
        "/**",
        " * @This test suite provides a comprehensive framework for auditing and verifying the security of ",
        " * Yield protocols, covering most aspects identified in the knowledge base documents ",
        " * as well as industry best practices for bridge security.",
        " */",
        "",
        "contract YieldProtocolTest is Test {",
        "    using SafeERC20 for IERC20;",
        "",
        "    address internal user = makeAddr(\"user\");",
        "    address internal admin = makeAddr(\"admin\");",
        "    address internal attacker = makeAddr(\"attacker\");",
        "",
        "    ERC20Mock internal WETH;",
        "    ERC4626Mock internal vault;",
        "",
        "    function setUp() public virtual {",
        "        vm.label(user, \"User\");",
        "        vm.label(admin, \"Admin\");",
        "        vm.label(attacker, \"Attacker\");",
        "",
        "        WETH = new ERC20Mock(\"Wrapped ETH\", \"WETH\", admin, 100_000e18);",
        "        vault = new ERC4626Mock(address(WETH), \"VaultToken\", \"VTKN\");",
        "",
        "        // Seed some initial balance and approvals",
        "        WETH.transfer(user, 50_000e18);",
        "        WETH.approve(address(vault), type(uint256).max);",
        "        vault.deposit(30_000e18, user);",
        "    }",
        "",
        "    // ##################################################################",
        "    // # DUST ACCUMULATION & ROUNDING ISSUES",
        "    // ##################################################################",
        "",
        "    function test_vault_allows_dust_deposits_but_creates_dust_on_redeem() public;",
        "    function test_vault_enforces_minimum_deposit_threshold_to_prevent_dust() public;",
        "    function test_preview_functions_round_user_favorably_instead_of_vault() public;",
        "    function test_rewards_calculation_handles_rounding_errors_with_large_TVL() public; ",
        "    function test_reward_distribution_does_not_lose_small_amounts_due_to_precision() public; ",
        "    function test_withdrawal_request_value_calculation_uses_correct_precision_for_different_tokens() public; ",
        "    function test_parameter_precision_issues_cause_significant_losses_in_leveraged_positions() public; ",
        "    function test_redeem_operation_with_minuscule_share_amount_does_not_revert() public; ",
        "    function test_mint_operation_with_minuscule_asset_amount_does_not_revert() public; ",
        "",
        "    // ##################################################################",
        "    // # REENTRANCY & CALLBACKS",
        "    // ##################################################################",
        "",
        "    function test_withdraw_callback_allows_reentrancy_attack_on_balance_state() public;",
        "    function test_withdraw_callback_is_secured_with_non_reentrant_guard() public;",
        "    function test_readOnly_reentrancy_in_removeLiquidity_function() public; ",
        "    function test_reentrancy_in_executeClaim_does_not_double_spend_rewards() public;",
        "    function test_reentrancy_in_withdraw_process_allows_stealing_funds_from_other_users() public;",
        "    function test_withdraw_process_is_secure_against_reentrancy_attacks_via_hooks() public; ",
        "",
        "    // ##################################################################",
        "    // # GOVERNANCE & UPGRADEABILITY",
        "    // ##################################################################",
        "",
        "    function test_governance_can_upgrade_logic_and_drain_vault_funds() public;",
        "    function test_governance_cannot_upgrade_without_proper_delay_or_role_check() public;",
        "    function test_pause_function_is_missing_and_allows_admin_to_freeze_users() public;",
        "    function test_pause_function_is_present_and_access_controlled() public;",
        "    function test_initializer_constructor_does_not_disable_initializers_for_upgrade_safety() public;",
        "    function test_initializer_removed_if_not_required_to_reduce_attack_surface() public;",
        "    function test_missing_pause_function_allows_unchecked_protocol_operations_during_emergency() public; ",
        "",
        "    // ##################################################################",
        "    // # STAKING & DELEGATION",
        "    // ##################################################################",
        "",
        "    function test_third_party_redeem_burns_shares_from_owner_even_when_allowance_used() public;",
        "    function test_third_party_redeem_only_spends_approved_allowance_and_not_more() public;",
        "    function test_requestWithdrawal_allows_anyone_to_initiate_with_valid_parameters() public; ",
        "    function test_rescueTokens_function_cannot_be_called_by_authorized_addresses() public; ",
        "    function test_position_cannot_be_unwound_after_transfer_to_new_owner() public; ",
        "    function test_delegate_stake_does_not_check_if_validator_contract_is_deployed() public;",
        "    function test_delegate_stake_checks_contract_code_size_before_making_call() public;",
        "    function test_delegate_call_allows_blacklisted_addresses_to_participate_in_staking() public;",
        "    function test_delegate_call_restricts_blacklisted_addresses_from_staking() public;",
        "    function test_delegate_call_uses_untrusted_sender_and_allows_abuse() public;",
        "",
        "    // ##################################################################",
        "    // # ORACLE & EXTERNAL DATA",
        "    // ##################################################################",
        "",
        "    function test_getOraclePrice_returns_correct_exchange_rate_between_tokens() public; ",
        "    function test_oracle_price_update_prevents_median_feeder_manipulation() public; ",
        "    function test_trading_module_handles_negative_interest_rates_gracefully() public; ",
        "",
        "    // ##################################################################",
        "    // # APPROVAL & ALLOWANCE HANDLING",
        "    // ##################################################################",
        "",
        "    function test_approve_allows_spender_to_take_more_than_expected_through_race_condition() public;",
        "    function test_swapOn1INCH_reverts_gracefully_on_insufficient_output_due_to_existing_balances() public; ",
        "    function test_allowance_spent_only_for_current_transaction_preventing_front_running() public; ",
        "    function test_approve_uses_calldata_and_not_copying_to_memory_unnecessarily() public;",
        "    function test_approve_implements_addition_assignment_operator_for_gas_savings() public;",
        "",
        "    // ##################################################################",
        "    // # EVENT & LOGGING BEST PRACTICES",
        "    // ##################################################################",
        "",
        "    function test_key_parameter_changes_do_not_emit_events_after_state_update() public;",
        "    function test_reward_transfer_emits_event_even_when_transfer_fails() public; ",
        "    function test_withdrawal_request_creation_emits_all_relevant_parameters() public; ",
        "",
        "    // ##################################################################",
        "    // # RESERVES & INVARIANT TESTING",
        "    // ##################################################################",
        "",
        "    function test_reserves_integrity_holds_after_removing_liquidity_in_generalized_AMM() public; ",
        "    function test_vault_total_assets_equals_underlying_plus_external_protocol_balance() public; ",
        "",
        "    // ##################################################################",
        "    // # SLIPPAGE & SWAP SECURITY",
        "    // ##################################################################",
        "",
        "    function test_slippage_protection_applies_even_when_asset_balance_already_exists() public; ",
        "    function test_swap_executes_at_correct_price_even_with_large_order_sizes() public;",
        "    function test_first_trade_in_staked_token_swap_uses_proper_slippage_protection() public; ",
        "    function test_hardcoded_slippage_allows_front_running_and_results_in_fund_losses() public; ",
        "    function test_max_deposit_function_returns_value_greater_than_what_can_be_deposited() public; ",
        "    function test_slippage_check_works_in_swapOn1INCH() public;",
        "    function test_swapOn1INCH_reverts_on_low_level_call_failure() public;",
        "    function test_slippage_check_prevents_front_running_by_using_min_pt_out() public;",
        "    function test_swapOn1INCH_reverts_gracefully_on_insufficient_output() public;",
        "",
        "    // ##################################################################",
        "    // # FEE-ON-TRANSFER & ERC20 EDGE CASES",
        "    // ##################################################################",
        "",
        "    function test_safeTransfer_handled_correctly_with_fee_on_transfer_tokens() public; ",
        "    function test_fee_on_transfer_tokens_do_not_break_withdrawal_share_calculations() public; ",
        "    function test_fee_on_transfer_tokens_result_in_incorrect_share_calculations_in_leveraged_positions() public; ",
        "    function test_cumulativeFees_updated_based_on_actual_received_amount_rather_than_transferred() public; ",
        "    function test_transfer_amount_is_checked_before_calling_to_prevent_unnecessary_reverts() public; ",
        "    function test_transfer_of_token_on_remove_liquidity_handles_fee_on_transfer_tokens() public; ",
        "",
        "    // ##################################################################",
        "    // # OWNERSHIP & ACCESS CONTROL",
        "    // ##################################################################",
        "",
        "    function test_owner_can_call_setYieldManager_and_setRelayer_successfully() public; ",
        "    function test_critical_functions_have_proper_access_control_restrictions() public; ",
        "    function test_admin_cannot_bypass_access_control_to_pause_unrelated_functions() public;",
        "    function test_owner_renounce_allows_abandonment_of_protocol_controls() public; ",
        "    function test_emergency_methods_are_accessible_only_to_admin() public;",
        "",
        "    // ##################################################################",
        "    // # BOOST PERIODS & REWARDS CALCULATIONS",
        "    // ##################################################################",
        "",
        "    function test_rewards_distribution_accounts_for_boost_periods_correctly() public; ",
        "    function test_reward_rate_calculation_handles_future_boost_periods() public; ",
        "    function test_claim_rewards_does_not_overwrite_account_debt_when_transfer_fails() public; ",
        "    function test_rpl_stake_withdrawal_considers_locked_stake_balance_correctly() public; ",
        "    function test_rpl_stake_calculation_does_not_exceed_total_stated_amount_during_withdrawal() public; ",
        "",
        "    // ##################################################################",
        "    // # MERKLE PROOFS & VOTING SYSTEMS",
        "    // ##################################################################",
        "",
        "    function test_merkle_tree_verification_fails_for_invalid_depth_challenge_indices() public; ",
        "    function test_merkle_pollard_verification_checks_leaf_indices_up_to_max_tree_depth() public; ",
        "    function test_challenge_response_marks_challenge_as_responded_only_after_verification() public; ",
        "    function test_vote_cast_in_phase_two_requires_valid_merkle_proof() public; ",
        "    function test_pollard_root_index_calculation_reverts_for_indices_exceeding_max_tree_depth() public; ",
        "",
        "    // ##################################################################",
        "    // # WITHDRAWAL & LIQUIDITY HANDLING",
        "    // ##################################################################",
        "",
        "    function test_withdrawal_request_finalization_validates_pending_withdrawal_addresses() public; ",
        "    function test_withdrawal_request_processing_does_not_overwrite_newer_pending_addresses() public; ",
        "    function test_liquidator_handling_when_vault_shares_less_than_total_shares() public; ",
        "    function test_partial_redemption_does_not_leave_unrecoverable_funds_in_protocol() public; ",
        "    function test_split_withdraw_request_makes_invalid_withdraw_requests_in_edge_cases() public; ",
        "    function test_withdraw_request_id_generation_follows_predictable_pattern_causing_DoS_risk() public; ",
        "    function test_protocol_handles_empty_withdrawal_requests_gracefully_without_reverting() public; ",
        "",
        "    // ##################################################################",
        "    // # PROTOCOL SETTINGS & INITIALIZATION",
        "    // ##################################################################",
        "",
        "    function test_protocol_settings_initialization_does_not_allow_inconsistent_state() public; ",
        "    function test_snapshot_amendment_verifies_block_matches_previous_checkpoint() public; ",
        "    function test_old_contract_versions_match_deployed_mainnet_contracts() public; ",
        "    function test_implementations_match_rpip_specifications_for_critical_parameters() public; ",
        "",
        "    // ##################################################################",
        "    // # UNUSED CODE & MISLEADING PATTERNS",
        "    // ##################################################################",
        "",
        "    function test_unused_variables_increase_gas_costs_and_impact_code_clarity() public; ",
        "    function test_unused_modifiers_lead_to_unexpected_contract_behavior() public; ",
        "    function test_misleading_revert_messages_confuse_protocol_interactions() public; ",
        "    function test_unused_imports_increase_attack_surface_and_reduce_readability() public; ",
        "",
        "    // ##################################################################",
        "    // # LEVERAGE & POSITION HANDLING",
        "    // ##################################################################",
        "",
        "    function test_leverage_position_handles_zero_leverage_scenarios_correctly() public; ",
        "    function test_leverage_position_does_not_burn_unused_arch_tokens() public; ",
        "    function test_rebase_events_do_not_lock_positions_forever_due_to_incorrect_ousd_tracking() public; ",
        "    function test_leverage_ratio_limits_prevent_excessive_risk_accumulation() public; ",
        "",
        "    // ##################################################################",
        "    // # GAS OPTIMIZATIONS",
        "    // ##################################################################",
        "",
        "    function test_unchecked_math_operations_save_gas_where_underflow_overflow_not_possible() public; ",
        "    function test_cached_variables_reduce_multiple_storage_reads_in_loop_operations() public; ",
        "    function test_adding_checks_before_state_changes_avoids_unnecessary_computation() public; ",
        "    function test_using_bit_packing_reduces_storage_writes_for_multiple_boolean_values() public; ",
        "    function test_using_mapping_deletion_instead_of_iterative_zeroing_saves_gas() public; ",
        "    function test_function_arguments_use_calldata_instead_of_memory_for_cost_efficiency() public;",
        "    function test_function_naming_and_comments_follow_consistent_style_across_protocol() public;",
        "    function test_nat_spec_comments_are_added_to_all_public_functions() public;",
        "    function test_file_name_matches_contract_name_to_avoid_compilation_issues() public;",
        "    function test_hardcoded_fee_token_prevents_discount_usage__should_be_configurable() public;",
        "    function test_ccip_message_receiver_is_verified_against_trusted_peer_list() public;",
        "    function test_ccip_message_decoding_reverts_gracefully_on_invalid_signature() public;",
        "    function test_ccip_message_processing_handles_out_of_order_or_duplicate_messages() public;",
        "",
        "    // ##################################################################",
        "    // # MATH & PRECISION",
        "    // ##################################################################",
        "",
        "    function test_mulDiv_operation_handles_rounding_errors_correctly_with_large_numbers() public; ",
        "    function test_fixed_point_math_operations_preserve_precision_across_multiple_calculations() public; ",
        "    function test_yield_fee_calculation_does_not_lose_precision_with_small_percentage_values() public; ",
        "    function test_redeem_operations_with_edge_case_share_to_asset_ratios_work_correctly() public; ",
        "",
        "    // ##################################################################",
        "    // # MISCELLANEOUS / NON-CRITICAL",
        "    // ##################################################################",
        "",
        "    function test_unnecessary_initialization_wastes_gas_in_constructor() public;",
        "    function test_withdraw_request_id_generation_follows_predictable_pattern() public; ",
        "    function test_multiple_partial_redemptions_do_not_lose_funds_in_final_withdrawal() public; ",
        "}",
        "",
        "/**",
        " * @This test suite provides a comprehensive framework for auditing and verifying the security of ",
        " * cross-chain bridge protocols, covering most aspects identified in the knowledge base documents ",
        " * as well as industry best practices for bridge security.",
        " */",
        "",
        "",
        "contract BridgeProtocolTest is Test {",
        "    address internal user = makeAddr(\"user\");",
        "    address internal admin = makeAddr(\"admin\");",
        "    address internal relayer = makeAddr(\"relayer\");",
        "    address internal attacker = makeAddr(\"attacker\");",
        "",
        "    function setUp() public virtual {",
        "        vm.label(user, \"User\");",
        "        vm.label(admin, \"Admin\");",
        "        vm.label(relayer, \"Relayer\");",
        "        vm.label(attacker, \"Attacker\");",
        "    }",
        "",
        "    // ##################################################################",
        "    // # ACCESS CONTROL & PERMISSIONING",
        "    // ##################################################################",
        "",
        "    function test_AccessControl_Only_Admin_Can_Add_Remove_Guardians() public;",
        "    function test_Admin_Cannot_Bypass_Permissioning_For_Critical_Functions() public;",
        "    function test_Paused_State_Prevents_Unauthorized_Transfers_Safely() public;",
        "    function test_Relayers_Have_Proper_Role_For_Staking_Interactions() public;",
        "    function test_Emergency_Exit_Role_Can_Only_Initiate_Queued_Exits() public;",
        "    function test_Functions_Require_Valid_Contract_To_Execute() public;",
        "",
        "    // ##################################################################",
        "    // # MESSAGE PASSING & VERIFICATION",
        "    // ##################################################################",
        "",
        "    function test_Message_Verification_Fails_With_Invalid_Signatures() public;",
        "    function test_Double_Message_Execution_Is_Detected_And_Reverted() public;",
        "    function test_Message_Expiry_Enforces_Time_Limit_For_Execution() public;",
        "    function test_Domain_Separator_Validates_Correct_Chain_Id_And_Version() public;",
        "    function test_Merkle_Tree_Verification_Fails_On_Invalid_Proof() public;",
        "    function test_Nonce_Increment_Ensures_Sequential_Message_Order() public;",
        "    function test_EIP712_Struct_Field_Ordering_Matches_TypeHash_Definition() public;",
        "    function test_Validator_Cannot_Process_Message_If_Not_Deployed() public;",
        "    function test_Address_Used_In_Swap_Check_Is_Not_Null() public;",
        "    function test_Signer_Address_Matches_Caller_In_Withdrawal_Request() public;",
        "    function test_Signature_V_Parameter_Is_Valid_27_Or_28() public;",
        "",
        "    // ##################################################################",
        "    // # FINALITY & CONFIRMATION SECURITY",
        "    // ##################################################################",
        "",
        "    function test_Finality_Threshold_Requires_Minimum_Confirmations() public;",
        "    function test_Confirmation_Weight_Prevents_Sybil_Attacks() public;",
        "    function test_Blockhash_Finalization_Checks_Valid_Light_Client_Data() public;",
        "    function test_Challenging_Window_Allows_Dispute_Of_Invalid_Header() public;",
        "",
        "    // ##################################################################",
        "    // # TOKEN HANDLING & ACCOUNTING",
        "    // ##################################################################",
        "",
        "    function test_Token_Mapping_Uses_Correct_Asset_Conversion() public;",
        "    function test_Withdrawals_Do_Not_Double_Spend_Funds() public;",
        "    function test_Fee_Calculation_Handles_Extreme_Value_Edge_Cases() public;",
        "    function test_Slippage_Protection_Works_With_Asset_Balance() public;",
        "    function test_Zero_Fee_Setting_Is_Validated_Before_Application() public;",
        "    function test_Balance_Update_Prevents_Underflow_Overflow_In_Transfer() public;",
        "    function test_Transfer_Error_Handling_Does_Not_Revert_Other_Operations() public;",
        "    function test_Transfer_With_FeeOnTransfer_Tokens_Is_Safe_Handle() public;",
        "    function test_Deflationary_Token_Transfers_Do_Not_Break_Bridge_Accounting() public;",
        "",
        "    // ##################################################################",
        "    // # REENTRANCY & CALLBACK SECURITY",
        "    // ##################################################################",
        "",
        "    function test_Withdraw_Process_Is_Secure_Against_Reentrancy_Attacks() public;",
        "    function test_Callback_Handler_Prevents_Multiple_Executions() public;",
        "    function test_NonReentrant_Guard_Work_Across_CrossChain_Hooks() public;",
        "    function test_Execute_Claim_Function_Is_Reentrancy_Safe() public;",
        "    function test_Remove_Liquidity_Function_Is_Secure_Against_Reentrancy() public;",
        "",
        "    // ##################################################################",
        "    // # EMERGENCY PROCEDURES",
        "    // ##################################################################",
        "",
        "    function test_Pause_Function_Stops_Transfers_Without_Loss_Of_Funds() public;",
        "    function test_Emergency_Shutdown_Allows_Fund_Withdrawals_Safely() public;",
        "    function test_Guardian_Council_Can_Trigger_Circuit_Breaker_When_Required() public;",
        "",
        "    // ##################################################################",
        "    // # DATA AVAILABILITY",
        "    // ##################################################################",
        "",
        "    function test_Header_Verification_Includes_All_Required_Fields() public;",
        "    function test_Light_Client_Stores_Minimum_Required_Chain_Data() public;",
        "    function test_Data_Availability_Checker_Validates_Storage_Proofs() public;",
        "",
        "    // ##################################################################",
        "    // # FEE & INCENTIVE MECHANISMS",
        "    // ##################################################################",
        "",
        "    function test_Fee_Distribution_Fairly_Compensates_Relayers() public;",
        "    function test_Slash_Mechanism_Functions_For_Malicious_Behavior() public;",
        "    function test_Fee_Reserves_Are_Adequately_Capitalized() public;",
        "    function test_Fees_Should_Be_Configurable_Not_Hardcoded() public;",
        "    function test_YieldFeeRecipient_Cannot_Claim_More_Than_Entitled() public;",
        "",
        "    // ##################################################################",
        "    // # UPGRADEABILITY & INITIALIZATION",
        "    // ##################################################################",
        "",
        "    function test_Upgrade_Schedule_Allows_Time_For_Security_Audit() public;",
        "    function test_Implementation_Changes_Require_Security_Multisig_Approval() public;",
        "    function test_Upgrades_Preserve_User_Fund_Integrity() public;",
        "    function test_Deprecated_Contracts_Are_Clearly_Flagged_And_Frozen() public;",
        "",
        "    // ##################################################################",
        "    // # CRYPTOGRAPHIC SECURITY",
        "    // ##################################################################",
        "",
        "    function test_ECDSA_Signature_Validation_Uses_Strict_Recovery() public;",
        "    function test_BLS_Signature_Aggregation_Maintains_Security() public;",
        "    function test_Recovered_Signatory_Address_Matches_Original_Signer() public;",
        "    function test_Oracle_Hash_Validation_Matches_Precompile_Output() public;",
        "",
        "    // ##################################################################",
        "    // # NETWORK LAYER INTERFACES",
        "    // ##################################################################",
        "",
        "    function test_CCIP_Message_Receiver_Verifies_Source_Chain_Identity() public;",
        "    function test_Message_Decoding_Reverts_On_Invalid_Input() public;",
        "    function test_Outbox_Processor_Validates_Message_Status_Before_Execution() public;",
        "    function test_Inbox_Processor_Rejects_Messages_From_Untrusted_Senders() public;",
        "",
        "    // ##################################################################",
        "    // # CROSS-CHAIN SYNCHRONIZATION",
        "    // ##################################################################",
        "",
        "    function test_CrossChain_Call_Timeout_Protects_Against_Stale_Requests() public;",
        "    function test_State_Commitment_Updates_Are_Timely_And_Ordered() public;",
        "    function test_Sequence_Verification_Matches_Remote_Chain_View() public;",
        "",
        "    // ##################################################################",
        "    // # ERROR HANDLING & CUSTOM ERRORS",
        "    // ##################################################################",
        "",
        "    function test_Custom_Errors_Provide_Descriptive_Messages_For_Debugging() public;",
        "    function test_Empty_Inputs_Trigger_Clear_Error_Messages() public;",
        "    function test_Invalid_Function_Calls_Throw_Appropriate_Exceptions() public;",
        "    function test_Validation_Errors_Contain_Exact_Parameter_Info() public;",
        "",
        "    // ##################################################################",
        "    // # ORACLE & EXTERNAL DATA",
        "    // ##################################################################",
        "",
        "    function test_Chainlink_Oracle_Returns_NonZero_Price_Under_Normal_Conditions() public;",
        "    function test_Zero_Price_Value_Does_Not_Break_Bridge_Exchange_Rate() public;",
        "    function test_Price_Decimals_Are_Correctly_Handled_In_Trade_Calculations() public;",
        "    function test_Two_Oracle_Price_Comparison_Uses_Consistent_Tokens_And_Decimals() public;",
        "    function test_Oracle_Price_Feed_Prevents_Stale_Or_Manipulated_Data() public;",
        "",
        "    // ##################################################################",
        "    // # STRUCT DECODING & INPUT HANDLING",
        "    // ##################################################################",
        "",
        "    function test_Struct_Field_Alignment_Matches_Encoded_TypeHash() public;",
        "    function test_Decode_Offset_Is_Validated_Before_Reading_Input_Data() public;",
        "    function test_Price_Struct_Decoding_Handles_Invalid_Offsets_Properly() public;",
        "    function test_KS_Decoding_Functions_Handle_Unsigned_Values_Correctly() public;",
        "",
        "    // ##################################################################",
        "    // # GAS OPTIMIZATIONS",
        "    // ##################################################################",
        "",
        "    function test_Use_Assembly_For_Hash_Calculations_Where_Applicable() public;",
        "    function test_Private_Variables_Save_Gas_Over_Public_Getters() public;",
        "    function test_Cached_Variables_Reduce_Storage_Reads_In_Loops() public;",
        "    function test_Zero_To_NonZero_Write_Is_Avoided_Where_Possible() public;",
        "    function test_PreIncrement_Used_Instead_Of_PostIncrement_For_Savings() public;",
        "    function test_Function_Arguments_Use_Calldata_Instead_Of_Memory() public;",
        "    function test_File_Name_Match_Contract_Name_To_Prevent_Compile_Errors() public;",
        "",
        "    // ##################################################################",
        "    // # ECONOMIC SECURITY",
        "    // ##################################################################",
        "",
        "    function test_Validator_Bond_Is_Sufficient_To_Prevent_Byzantine_Behavior() public;",
        "    function test_Challenge_Period_Allows_Time_For_Fraud_Detection() public;",
        "    function test_Security_Budget_Allocation_Balances_Cost_And_Risk() public;",
        "",
        "    // ##################################################################",
        "    // # MISCELLANEOUS / NON-CRITICAL ISSUES",
        "    // ##################################################################",
        "",
        "    function test_Documentation_Accurately_Describes_Code_Behavior() public;",
        "    function test_Comments_Are_Free_Of_Typos_Or_Misleading_Info() public;",
        "    function test_Events_Include_All_Parameters_For_Offchain_Indexing() public;",
        "    function test_Predictable_Withdraw_Request_ID_Pattern_Is_Secure() public;",
        "    function test_Native_Transfer_Usage_Is_Checked_Before_Wrapping() public;",
        "}",
        "",
        "/*",
        " * This test suite addresses the unique security considerations of staking pool implementations.",
        " */",
        "",
        "contract StakingProtocolTest is Test {",
        "    using SafeERC20 for IERC20;",
        "",
        "    address internal user = makeAddr(\"user\");",
        "    address internal admin = makeAddr(\"admin\");",
        "    address internal attacker = makeAddr(\"attacker\");",
        "    address internal liquidator = makeAddr(\"liquidator\");",
        "",
        "    function setUp() public virtual {",
        "        vm.label(user, \"User\");",
        "        vm.label(admin, \"Admin\");",
        "        vm.label(attacker, \"Attacker\");",
        "        vm.label(liquidator, \"Liquidator\");",
        "    }",
        "",
        "    // ##################################################################",
        "    // # ACCESS CONTROL & PERMISSIONING",
        "    // ##################################################################",
        "",
        "    function test_AccessControl_Only_Allowed_Roles_Can_Modify_Staking_Params() public;",
        "    function test_Admin_Cannot_Bypass_Permission_For_Critical_Functions() public;",
        "    function test_Relayers_Have_Valid_Permissions_For_Staking_Interactions() public;",
        "    function test_Paused_State_Prevents_Unauthorized_Transfers_Safely() public;",
        "    function test_FlashLoan_Control_Is_Governance_Locked() public; // From BadgerDAO flashLoanPaused flag",
        "    function test_Guardian_Council_Can_Activate_Circuit_Breaker_In_Emergency() public;",
        "    function test_Liquidator_Cannot_Process_Expired_Liens_Multiple_Times() public; // Astaria issue",
        "    function test_Vault_Shutdown_Prevents_Commitment_To_New_Liens() public; // Astaria issue",
        "",
        "    // ##################################################################",
        "    // # STAKING & UNSTAKING FUNCTIONALITY",
        "    // ##################################################################",
        "",
        "    function test_User_Can_Successfully_Stake_Tokens() public;",
        "    function test_Staking_Updates_User_Balance_And_Total_Supply_Correctly() public;",
        "    function test_Unstaking_Transfers_Exactly_The_Intended_Amount() public;",
        "    function test_Unstaking_Updates_State_Variables_Properly() public;",
        "    function test_Staking_Min_And_Max_Limits_Are_Enforced() public;",
        "    function test_Zero_Value_Staking_Request_Is_Rejected_With_Clear_Error() public;",
        "    function test_Staking_With_Deflationary_Tokens_Does_Not_Corrupt_Accounting() public;",
        "    function test_Staking_With_FeeOnTransfer_Tokens_Handles_Share_Calculations_Correctly() public;",
        "    function test_Staking_With_Rebase_Tokens_Handles_Adjustments_Safely() public;",
        "",
        "    // ##################################################################",
        "    // # REWARD DISTRIBUTION & LIQUIDITY INTEGRATION",
        "    // ##################################################################",
        "",
        "    function test_Reward_Calculation_Is_Fair_And_Transparent() public;",
        "    function test_Reward_Claim_Updates_User_State_Only_On_Success() public;",
        "    function test_Multiple_Reward_Tokens_Are_Tracked_And_Claimed_Correctly() public;",
        "    function test_Undistributed_Rewards_Are_Rolled_Over_To_Next_Epoch() public; // Velodrome issue",
        "    function test_Reward_Notification_Does_Not_Reduce_Trading_Price_NonReentrancy() public; // Spearbit finding",
        "    function test_Reward_Claim_Handles_Small_Token_Balances_Without_Loss() public;",
        "    function test_Increase_Lien_By_Borrower_Resets_Strategist_Fee_Calculation() public; // Astaria issue",
        "    function test_Secondary_Reward_Tokens_Are_Not_Lost_After_Callback_Attack() public; // Reentrancy safe",
        "",
        "    // ##################################################################",
        "    // # REENTRANCY SECURITY",
        "    // ##################################################################",
        "",
        "    function test_Staking_Function_Is_Secure_Against_Reentrancy_Attacks() public;",
        "    function test_Unstaking_Function_Is_Secure_Against_Reentrancy_Attacks() public;",
        "    function test_Reward_Claim_Is_Secure_Against_Reentrancy_Attacks() public;",
        "    function test_Callback_Handlers_Prevent_Double_Execution_In_Same_Block() public;",
        "    function test_Liquidation_Callback_Is_Secure_From_Reentrancy() public;",
        "    function test_RemoveLiquidity_Function_Is_Reentrancy_Safe() public; // Archimedes-style hook reentrancy",
        "",
        "    // ##################################################################",
        "    // # LIQUIDATION & BAD DEBT HANDLING",
        "    // ##################################################################",
        "",
        "    function test_Liquidation_Checks_For_Stale_Liens_Before_Processing() public;",
        "    function test_Bad_Debt_Is_Not_Transferred_To_NonRedeeming_Shareholders() public; // Astaria issue",
        "    function test_Partial_Liquidation_Resets_Bad_Debt_Index_Properly() public; // BadgerDAO improvement",
        "    function test_Liquidator_Cannot_Selectively_Liquidate_For_Maximum_Incentives() public; // BadgerDAO finding",
        "    function test_Liquidation_Does_Not_Allow_Dust_CDPS_To_Break_Operations() public;",
        "    function test_Liquidator_Cannot_Process_Expired_Liens_Multiple_Times() public;",
        "",
        "    // ##################################################################",
        "    // # SWAP & NATIVE TRANSFER ISSUES",
        "    // ##################################################################",
        "",
        "    function test_SwapRouter_Refunds_Unspent_ETH_After_Swapping() public; // Velodrome finding",
        "    function test_Native_Token_Transfer_Outside_Unwrap_Handles_All_Values_Safely() public; // Sushi Cantina fix",
        "    function test_Native_Token_Unwrap_In_Wrong_Context_Results_In_No_Loss() public; // Sushi Cantina fix",
        "    function test_swapCurve_Function_Handles_Approve_With_No_Return_Value() public; // Sushi Cantina issue",
        "    function test_transferFunction_Is_Replaced_With_Call_For_Native_Safety() public; // Astaria replacement",
        "",
        "    // ##################################################################",
        "    // # FEE CALCULATION & INCENTIVES",
        "    // ##################################################################",
        "",
        "    function test_Fee_Calculation_Handles_Extreme_Values_Safely() public;",
        "    function test_Yield_Fee_Is_Rounded_Upward_For_Protocol_Safety() public;",
        "    function test_Strategist_Fee_Uses_Correct_Parameters_When_Issuing_Rewards() public; // Astaria issue",
        "    function test_Fees_Are_Configurable_Instead_Of_Hardcoded() public; // Prevent fund loss",
        "    function test_Fee_Recipients_Cannot_Claim_More_Than_Entitled() public;",
        "    function test_Base_Fee_Changes_Are_Restricted_By_Governance() public;",
        "    function test_Full_Restricted_Stakers_Cannot_Bypass_Approvals() public; // Ethena M-01",
        "    function test_Soft_Restricted_Role_Cannot_Withdraw_For_USDe_Escrow_Tokens() public; // Ethena M-02",
        "",
        "    // ##################################################################",
        "    // # WITHDRAWAL & REQUEST HANDLING",
        "    // ##################################################################",
        "",
        "    function test_Withdraw_Request_ID_Is_Not_Predictable_For_DoS_Prevention() public;",
        "    function test_Multiple_Withdrawals_Do_Not_Leave_Unclaimed_Funds() public;",
        "    function test_Withdrawal_Process_Uses_Configurable_Timeouts() public;",
        "    function test_Finalize_Withdrawal_Requires_Validating_Message_Ordering() public;",
        "    function test_initiate_Withdrawal_With_Zero_Shares_Reverts_Gracefully() public;",
        "    function test_withdrawProcess_Is_Secure_After_CrossChain_Callbacks() public;",
        "    function test_Withdrawal_Request_Handles_Small_Remaining_Balances() public;",
        "",
        "    // ##################################################################",
        "    // # MESSAGE PASSING & VERIFICATION",
        "    // ##################################################################",
        "",
        "    function test_Message_Verification_Fails_With_Invalid_Signatures() public;",
        "    function test_Double_Message_Execution_Is_Detected_And_Reverted() public;",
        "    function test_Message_Expiry_Enforces_Time_Limit_For_Execution() public;",
        "    function test_Domain_Separator_Uses_Correct_Chain_Id_And_Versioning() public;",
        "    function test_CrossChain_Call_Timeout_Protects_Against_Stale_Requests() public;",
        "",
        "    // ##################################################################",
        "    // # GOVERNANCE INTERACTIONS",
        "    // ##################################################################",
        "",
        "    function test_Governance_Can_Set_New_Staking_Parameters() public;",
        "    function test_Governance_Change_Requires_Min_Delay_Between_Approval_And_Activation() public;",
        "    function test_Governance_Can_Pause_Staking_In_Emergency_Scenario() public;",
        "    function test_Governance_Cannot_Create_Empty_Or_Invalid_Epochs() public;",
        "    function test_Governance_Events_Trigger_Correct_Parameter_Changes() public;",
        "    function test_Governance_Can_Cancel_Unexecuted_Vault_Creation_Requests() public; // Astaria DoS prevention",
        "",
        "    // ##################################################################",
        "    // # TOKEN HANDLING & ERC20 EDGE CASES",
        "    // ##################################################################",
        "",
        "    function test_Token_Transfer_With_FeeOnTransfer_Handles_Allowing_Safely() public;",
        "    function test_Token_Allowance_Transfer_With_No_Return_Value_Is_Handled() public;",
        "    function test_Token_With_Null_Code_Size_Cannot_Be_Used_As_Reward() public; // Malformed token",
        "    function test_Deflationary_Token_Transfers_Update_Balance_Correctly() public;",
        "    function test_Rebase_Token_Balance_Adjustments_Do_Not_Block_Liquidation() public;",
        "    function test_Token_TransferError_Does_Not_Revert_Critical_Operations() public; // Based on multiple reports",
        "",
        "    // ##################################################################",
        "    // # FLASH LOAN & CALLBACK HANDLING",
        "    // ##################################################################",
        "",
        "    function test_FlashLoan_Returns_Correct_Amount_With_Fee_Calculation() public;",
        "    function test_FlashLoan_Reverts_If_Max_FlashLoan_Is_Exceeded() public;",
        "    function test_FlashLoan_Flag_Pauses_Allows_Control_Over_Loan_State() public; // BadgerDAO flag-based logic",
        "    function test_Callback_Extra_Data_Validation_Prevents_Malicious_Encoded_Orders() public; // Astaria advanced order issue",
        "    function test_FlashFee_Function_Is_Only_Allowed_When_FlashLoans_Are_Active() public; // BadgerDAO control",
        "",
        "    // ##################################################################",
        "    // # ORACLE & SLIPPAGE PROTECTION",
        "    // ##################################################################",
        "",
        "    function test_Oracle_Returns_NonZero_Price_Under_Normal_Conditions() public;",
        "    function test_Zero_Price_Value_Does_Not_Break_Exchange_Rate_Calculations() public;",
        "    function test_Price_Decimals_Are_Correctly_Handled_In_Swaps() public;",
        "    function test_Slippage_Protection_Is_Enabled_For_All_Swap_Functions() public;",
        "    function test_Swap_Slippage_Is_Customizable_Not_Hardcoded() public;",
        "    function test_Position_Shutdown_Handles_Slippage_With_Rebalance() public; // Astaria shutdown issue",
        "",
        "    // ##################################################################",
        "    // # PERMIT & APPROVAL HANDLING",
        "    // ##################################################################",
        "",
        "    function test_Permit_Signature_Cannot_Be_Used_After_Expiry() public;",
        "    function test_Permit_Signature_Malleability_Is_Checked() public;",
        "    function test_TransferFrom_Does_Not_Decrease_Allowance_If_Max_Set() public; // BadgerDAO transferFrom issue",
        "    function test_Too_Many_Approvals_Do_Not_Open_Attack_Surface() public;",
        "    function test_Invalid_Permit_Signatures_Are_Rejected() public;",
        "    function test_Token_Invalidate_All_Permit_Signatures_When_Transfer_Occurs() public; // BadgerDAO",
        "",
        "    // ##################################################################",
        "    // # UPGRADEABILITY & INITIALIZATION",
        "    // ##################################################################",
        "",
        "    function test_Implementation_Changes_Require_Security_Multisig_Approval() public;",
        "    function test_Deprecated_Functions_Are_Flagged_And_Disabled_PostUpgrade() public;",
        "    function test_Contract_Initialization_Is_Protected_Against_Repeats() public;",
        "    function test_Admin_Cannot_Upgrade_To_An_Older_Or_Same_Version() public;",
        "    function test_Reinitializer_Requires_Delay_Between_Init_Calls() public;",
        "",
        "    // ##################################################################",
        "    // # EMERGENCY PROCEDURES",
        "    // ##################################################################",
        "",
        "    function test_Pause_Functionality_Stops_Transfers_Without_Fund_Loss() public;",
        "    function test_Emergency_Shutdown_Allows_Users_To_Withdraw_Safely() public;",
        "    function test_Circuit_Breaker_Can_Be_Triggered_By_Guardians_Only() public;",
        "",
        "    // ##################################################################",
        "    // # DATA VALIDATION & INPUT SANITIZATION",
        "    // ##################################################################",
        "",
        "    function test_Order_Validator_Rejects_Malformed_Consideration_Amounts() public; // Astaria validation",
        "    function test_Input_Parameters_Are_Checked_Before_Internal_State_Changes() public;",
        "    function test_External_Callbacks_Are_Validated_Before_Storage_Writes() public; // From Astaria callback",
        "    function test_Liquidation_Amount_Is_Checked_Before_Transferring_Out() public;",
        "    function test_Borrower_Cannot_Create_Zero_Value_CDPs() public;",
        "",
        "    // ##################################################################",
        "    // # GAS OPTIMIZATION PATTERNS",
        "    // ##################################################################",
        "",
        "    function test_Private_Functions_Save_Gas_Over_Public_Getters() public;",
        "    function test_Function_Arguments_Use_Calldata_Instead_Of_Memory() public;",
        "    function test_Unchecked_Math_Is_Used_Where_Overflow_Is_Not_Possible() public;",
        "    function test_Boolean_Storage_Variables_Are_Packed_For_Efficiency() public;",
        "    function test_ZeroToNonZero_Write_Is_Avoided_Where_Not_Needed() public;",
        "    function test_PreIncrement_Used_In_Loop_Operations_For_Savings() public;",
        "",
        "    // ##################################################################",
        "    // # MISCELLANEOUS / NON-CRITICAL",
        "    // ##################################################################",
        "",
        "    function test_Event_Emission_Includes_All_Relevant_Metadata() public;",
        "    function test_Documentation_Accurately_Describes_Code_Behavior() public;",
        "    function test_Balance_Updates_Are_Logged_Before_Transfers() public;",
        "    function test_File_Name_Match_Contract_Name_For_Build_Integrity() public;",
        "}"
    ],
    "description": "This boilerplate contains most smart contract vulnerabilities discovered in 30+ security reviews."
}